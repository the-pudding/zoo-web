parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"or4r":[function(require,module,exports) {
var global = arguments[3];
var t=arguments[3],e="Expected a function",n=NaN,r="[object Symbol]",i=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,f=/^0o[0-7]+$/i,c=parseInt,a="object"==typeof t&&t&&t.Object===Object&&t,s="object"==typeof self&&self&&self.Object===Object&&self,v=a||s||Function("return this")(),l=Object.prototype,p=l.toString,b=Math.max,m=Math.min,y=function(){return v.Date.now()};function d(t,n,r){var i,o,u,f,c,a,s=0,v=!1,l=!1,p=!0;if("function"!=typeof t)throw new TypeError(e);function d(e){var n=i,r=o;return i=o=void 0,s=e,f=t.apply(r,n)}function g(t){var e=t-a;return void 0===a||e>=n||e<0||l&&t-s>=u}function O(){var t=y();if(g(t))return x(t);c=setTimeout(O,function(t){var e=n-(t-a);return l?m(e,u-(t-s)):e}(t))}function x(t){return c=void 0,p&&i?d(t):(i=o=void 0,f)}function T(){var t=y(),e=g(t);if(i=arguments,o=this,a=t,e){if(void 0===c)return function(t){return s=t,c=setTimeout(O,n),v?d(t):f}(a);if(l)return c=setTimeout(O,n),d(a)}return void 0===c&&(c=setTimeout(O,n)),f}return n=h(n)||0,j(r)&&(v=!!r.leading,u=(l="maxWait"in r)?b(h(r.maxWait)||0,n):u,p="trailing"in r?!!r.trailing:p),T.cancel=function(){void 0!==c&&clearTimeout(c),s=0,i=a=o=c=void 0},T.flush=function(){return void 0===c?f:x(y())},T}function j(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function g(t){return!!t&&"object"==typeof t}function O(t){return"symbol"==typeof t||g(t)&&p.call(t)==r}function h(t){if("number"==typeof t)return t;if(O(t))return n;if(j(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=j(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(i,"");var r=u.test(t);return r||f.test(t)?c(t.slice(2),r?2:8):o.test(t)?n:+t}module.exports=d;
},{}],"WEtf":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var r={android:function(){return navigator.userAgent.match(/Android/i)},blackberry:function(){return navigator.userAgent.match(/BlackBerry/i)},ios:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},opera:function(){return navigator.userAgent.match(/Opera Mini/i)},windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return r.android()||r.blackberry()||r.ios()||r.opera()||r.windows()}},e=r;exports.default=e;
},{}],"hZBy":[function(require,module,exports) {
"use strict";function e(e){return r(e)||n(e)||t()}function t(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function n(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function r(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function o(e){return document.querySelector(e)}function s(t){return e((arguments.length>1&&void 0!==arguments[1]?arguments[1]:document).querySelectorAll(t))}function c(t,n){return e(t.querySelectorAll(n))}function a(e,t){e.classList?e.classList.remove(t):e.className=e.className.replace(new RegExp("(^|\\b)".concat(t.split(" ").join("|"),"(\\b|$)"),"gi")," ")}function l(e,t){e.classList?e.classList.add(t):e.className="".concat(e.className," ").concat(t)}function i(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )".concat(t,"( |$)"),"gi").test(e.className)}function u(e,t){t=t||0;var n=e.getBoundingClientRect().top+t,r=(window.pageYOffset||document.documentElement.scrollTop)+n;window.scrollTo(0,r)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.select=o,exports.selectAll=s,exports.find=c,exports.removeClass=a,exports.addClass=l,exports.hasClass=i,exports.jumpTo=u;
},{}],"U9xJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=t;var e=require("./dom");function t(){(0,e.selectAll)("[target='_blank']").forEach(function(e){return e.setAttribute("rel","noopener")})}
},{"./dom":"hZBy"}],"xZJw":[function(require,module,exports) {
"use strict";function t(t){return new Promise(function(e,n){var o=t.split(".").pop();"csv"===o?d3.csv("".concat(t)).then(e).catch(n):"json"===o||"geojson"===o?d3.json("assets/data/".concat(t)).then(e).catch(n):n(new Error("unsupported file type for: ".concat(t)))})}function e(e){if("string"==typeof e)return t(e);var n=e.map(t);return Promise.all(n)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=e;
},{}],"TAPd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=a(require("./load-data"));function a(t){return t&&t.__esModule?t:{default:t}}var n=d3.select(".grid"),e=[];function c(){}function o(){var t=d3.select(this),a=t.attr("data-id");"png"===t.attr("data-type")?(t.attr("src","https://pudding-data-processing.s3.amazonaws.com/zoo-cams/output/".concat(a,".gif")),t.attr("data-type","gif")):(t.attr("src","https://pudding-data-processing.s3.amazonaws.com/zoo-cams/stills/".concat(a,".png")),t.attr("data-type","png"))}function r(){n.selectAll(".cam").data(e).join(function(t){var a=t.append("div").attr("class",function(t){return"cam cam--".concat(t.id)}),n=a.append("img").attr("class","cam__display").attr("data-id",function(t){return t.id}).attr("data-type","png").attr("src",function(t){return"https://pudding-data-processing.s3.amazonaws.com/zoo-cams/stills/".concat(t.id,".png")});a.append("p").text(function(t){return"ID: ".concat(t.id)}),a.append("p").text(function(t){return t.animal}),a.append("p").text(function(t){return t.facility}),n.on("click",o)})}function i(){(0,t.default)("https://raw.githubusercontent.com/the-pudding/zoo-data/master/zoos.csv").then(function(t){e=t,r()})}var s={init:i,resize:c};exports.default=s;
},{"./load-data":"xZJw"}],"VKu2":[function(require,module,exports) {
"use strict";function e(e){return new Promise(function(r,n){var o=new Image;o.onload=function(){return r(o)},o.onerror=function(){return n("error loading ".concat(e))},o.src=e})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var r=e;exports.default=r;
},{}],"CRRU":[function(require,module,exports) {
!function(){"use strict";if("object"==typeof window)if("IntersectionObserver"in window&&"IntersectionObserverEntry"in window&&"intersectionRatio"in window.IntersectionObserverEntry.prototype)"isIntersecting"in window.IntersectionObserverEntry.prototype||Object.defineProperty(window.IntersectionObserverEntry.prototype,"isIntersecting",{get:function(){return this.intersectionRatio>0}});else{var t=function(t){for(var e=window.document,n=i(e);n;)n=i(e=n.ownerDocument);return e}(),e=[],n=null,o=null;s.prototype.THROTTLE_TIMEOUT=100,s.prototype.POLL_INTERVAL=null,s.prototype.USE_MUTATION_OBSERVER=!0,s._setupCrossOriginUpdater=function(){return n||(n=function(t,n){o=t&&n?l(t,n):{top:0,bottom:0,left:0,right:0,width:0,height:0},e.forEach(function(t){t._checkForIntersections()})}),n},s._resetCrossOriginUpdater=function(){n=null,o=null},s.prototype.observe=function(t){if(!this._observationTargets.some(function(e){return e.element==t})){if(!t||1!=t.nodeType)throw new Error("target must be an Element");this._registerInstance(),this._observationTargets.push({element:t,entry:null}),this._monitorIntersections(t.ownerDocument),this._checkForIntersections()}},s.prototype.unobserve=function(t){this._observationTargets=this._observationTargets.filter(function(e){return e.element!=t}),this._unmonitorIntersections(t.ownerDocument),0==this._observationTargets.length&&this._unregisterInstance()},s.prototype.disconnect=function(){this._observationTargets=[],this._unmonitorAllIntersections(),this._unregisterInstance()},s.prototype.takeRecords=function(){var t=this._queuedEntries.slice();return this._queuedEntries=[],t},s.prototype._initThresholds=function(t){var e=t||[0];return Array.isArray(e)||(e=[e]),e.sort().filter(function(t,e,n){if("number"!=typeof t||isNaN(t)||t<0||t>1)throw new Error("threshold must be a number between 0 and 1 inclusively");return t!==n[e-1]})},s.prototype._parseRootMargin=function(t){var e=(t||"0px").split(/\s+/).map(function(t){var e=/^(-?\d*\.?\d+)(px|%)$/.exec(t);if(!e)throw new Error("rootMargin must be specified in pixels or percent");return{value:parseFloat(e[1]),unit:e[2]}});return e[1]=e[1]||e[0],e[2]=e[2]||e[0],e[3]=e[3]||e[1],e},s.prototype._monitorIntersections=function(e){var n=e.defaultView;if(n&&-1==this._monitoringDocuments.indexOf(e)){var o=this._checkForIntersections,r=null,s=null;if(this.POLL_INTERVAL?r=n.setInterval(o,this.POLL_INTERVAL):(h(n,"resize",o,!0),h(e,"scroll",o,!0),this.USE_MUTATION_OBSERVER&&"MutationObserver"in n&&(s=new n.MutationObserver(o)).observe(e,{attributes:!0,childList:!0,characterData:!0,subtree:!0})),this._monitoringDocuments.push(e),this._monitoringUnsubscribes.push(function(){var t=e.defaultView;t&&(r&&t.clearInterval(r),c(t,"resize",o,!0)),c(e,"scroll",o,!0),s&&s.disconnect()}),e!=(this.root&&this.root.ownerDocument||t)){var u=i(e);u&&this._monitorIntersections(u.ownerDocument)}}},s.prototype._unmonitorIntersections=function(e){var n=this._monitoringDocuments.indexOf(e);if(-1!=n){var o=this.root&&this.root.ownerDocument||t;if(!this._observationTargets.some(function(t){var n=t.element.ownerDocument;if(n==e)return!0;for(;n&&n!=o;){var r=i(n);if((n=r&&r.ownerDocument)==e)return!0}return!1})){var r=this._monitoringUnsubscribes[n];if(this._monitoringDocuments.splice(n,1),this._monitoringUnsubscribes.splice(n,1),r(),e!=o){var s=i(e);s&&this._unmonitorIntersections(s.ownerDocument)}}}},s.prototype._unmonitorAllIntersections=function(){var t=this._monitoringUnsubscribes.slice(0);this._monitoringDocuments.length=0,this._monitoringUnsubscribes.length=0;for(var e=0;e<t.length;e++)t[e]()},s.prototype._checkForIntersections=function(){if(this.root||!n||o){var t=this._rootIsInDom(),e=t?this._getRootRect():{top:0,bottom:0,left:0,right:0,width:0,height:0};this._observationTargets.forEach(function(o){var i=o.element,s=u(i),h=this._rootContainsTarget(i),c=o.entry,a=t&&h&&this._computeTargetAndRootIntersection(i,s,e),l=o.entry=new r({time:window.performance&&performance.now&&performance.now(),target:i,boundingClientRect:s,rootBounds:n&&!this.root?null:e,intersectionRect:a});c?t&&h?this._hasCrossedThreshold(c,l)&&this._queuedEntries.push(l):c&&c.isIntersecting&&this._queuedEntries.push(l):this._queuedEntries.push(l)},this),this._queuedEntries.length&&this._callback(this.takeRecords(),this)}},s.prototype._computeTargetAndRootIntersection=function(e,i,r){if("none"!=window.getComputedStyle(e).display){for(var s,h,c,a,f,d,g,m,v=i,_=p(e),b=!1;!b&&_;){var w=null,y=1==_.nodeType?window.getComputedStyle(_):{};if("none"==y.display)return null;if(_==this.root||9==_.nodeType)if(b=!0,_==this.root||_==t)n&&!this.root?!o||0==o.width&&0==o.height?(_=null,w=null,v=null):w=o:w=r;else{var I=p(_),E=I&&u(I),T=I&&this._computeTargetAndRootIntersection(I,E,r);E&&T?(_=I,w=l(E,T)):(_=null,v=null)}else{var R=_.ownerDocument;_!=R.body&&_!=R.documentElement&&"visible"!=y.overflow&&(w=u(_))}if(w&&(s=w,h=v,c=void 0,a=void 0,f=void 0,d=void 0,g=void 0,m=void 0,c=Math.max(s.top,h.top),a=Math.min(s.bottom,h.bottom),f=Math.max(s.left,h.left),d=Math.min(s.right,h.right),m=a-c,v=(g=d-f)>=0&&m>=0&&{top:c,bottom:a,left:f,right:d,width:g,height:m}||null),!v)break;_=_&&p(_)}return v}},s.prototype._getRootRect=function(){var e;if(this.root)e=u(this.root);else{var n=t.documentElement,o=t.body;e={top:0,left:0,right:n.clientWidth||o.clientWidth,width:n.clientWidth||o.clientWidth,bottom:n.clientHeight||o.clientHeight,height:n.clientHeight||o.clientHeight}}return this._expandRectByRootMargin(e)},s.prototype._expandRectByRootMargin=function(t){var e=this._rootMarginValues.map(function(e,n){return"px"==e.unit?e.value:e.value*(n%2?t.width:t.height)/100}),n={top:t.top-e[0],right:t.right+e[1],bottom:t.bottom+e[2],left:t.left-e[3]};return n.width=n.right-n.left,n.height=n.bottom-n.top,n},s.prototype._hasCrossedThreshold=function(t,e){var n=t&&t.isIntersecting?t.intersectionRatio||0:-1,o=e.isIntersecting?e.intersectionRatio||0:-1;if(n!==o)for(var i=0;i<this.thresholds.length;i++){var r=this.thresholds[i];if(r==n||r==o||r<n!=r<o)return!0}},s.prototype._rootIsInDom=function(){return!this.root||f(t,this.root)},s.prototype._rootContainsTarget=function(e){return f(this.root||t,e)&&(!this.root||this.root.ownerDocument==e.ownerDocument)},s.prototype._registerInstance=function(){e.indexOf(this)<0&&e.push(this)},s.prototype._unregisterInstance=function(){var t=e.indexOf(this);-1!=t&&e.splice(t,1)},window.IntersectionObserver=s,window.IntersectionObserverEntry=r}function i(t){try{return t.defaultView&&t.defaultView.frameElement||null}catch(e){return null}}function r(t){this.time=t.time,this.target=t.target,this.rootBounds=a(t.rootBounds),this.boundingClientRect=a(t.boundingClientRect),this.intersectionRect=a(t.intersectionRect||{top:0,bottom:0,left:0,right:0,width:0,height:0}),this.isIntersecting=!!t.intersectionRect;var e=this.boundingClientRect,n=e.width*e.height,o=this.intersectionRect,i=o.width*o.height;this.intersectionRatio=n?Number((i/n).toFixed(4)):this.isIntersecting?1:0}function s(t,e){var n,o,i,r=e||{};if("function"!=typeof t)throw new Error("callback must be a function");if(r.root&&1!=r.root.nodeType)throw new Error("root must be an Element");this._checkForIntersections=(n=this._checkForIntersections.bind(this),o=this.THROTTLE_TIMEOUT,i=null,function(){i||(i=setTimeout(function(){n(),i=null},o))}),this._callback=t,this._observationTargets=[],this._queuedEntries=[],this._rootMarginValues=this._parseRootMargin(r.rootMargin),this.thresholds=this._initThresholds(r.threshold),this.root=r.root||null,this.rootMargin=this._rootMarginValues.map(function(t){return t.value+t.unit}).join(" "),this._monitoringDocuments=[],this._monitoringUnsubscribes=[]}function h(t,e,n,o){"function"==typeof t.addEventListener?t.addEventListener(e,n,o||!1):"function"==typeof t.attachEvent&&t.attachEvent("on"+e,n)}function c(t,e,n,o){"function"==typeof t.removeEventListener?t.removeEventListener(e,n,o||!1):"function"==typeof t.detatchEvent&&t.detatchEvent("on"+e,n)}function u(t){var e;try{e=t.getBoundingClientRect()}catch(n){}return e?(e.width&&e.height||(e={top:e.top,right:e.right,bottom:e.bottom,left:e.left,width:e.right-e.left,height:e.bottom-e.top}),e):{top:0,bottom:0,left:0,right:0,width:0,height:0}}function a(t){return!t||"x"in t?t:{top:t.top,y:t.top,bottom:t.bottom,left:t.left,x:t.left,right:t.right,width:t.width,height:t.height}}function l(t,e){var n=e.top-t.top,o=e.left-t.left;return{top:n,left:o,height:e.height,width:e.width,bottom:n+e.height,right:o+e.width}}function f(t,e){for(var n=e;n;){if(n==t)return!0;n=p(n)}return!1}function p(e){var n=e.parentNode;return 9==e.nodeType&&e!=t?i(e):n&&11==n.nodeType&&n.host?n.host:n&&n.assignedSlot?n.assignedSlot.parentNode:n}}();
},{}],"vL5c":[function(require,module,exports) {
var define;
var global = arguments[3];
var e,t=arguments[3];!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof e&&e.amd?e(n):t.scrollama=n()}(this,function(){"use strict";function e(e){return"scrollama__debug-offset--"+e}function t(t){!function(t){var n=t.id,o=t.offsetVal,r=t.stepClass,i=document.createElement("div");i.id=e(n),i.className="scrollama__debug-offset",i.style.position="fixed",i.style.left="0",i.style.width="100%",i.style.height="0",i.style.borderTop="2px dashed black",i.style.zIndex="9999";var s=document.createElement("p");s.innerHTML='".'+r+'" trigger: <span>'+o+"</span>",s.style.fontSize="12px",s.style.fontFamily="monospace",s.style.color="black",s.style.margin="0",s.style.padding="6px",i.appendChild(s),document.body.appendChild(i)}({id:t.id,offsetVal:t.offsetVal,stepClass:t.stepEl[0].className})}function n(e){var t=e.id,n=e.index,o=e.state,r="scrollama__debug-step--"+t+"-"+n,i=document.getElementById(r+"_above"),s=document.getElementById(r+"_below"),a="enter"===o?"block":"none";i&&(i.style.display=a),s&&(s.style.display=a)}return function(){var o=["stepAbove","stepBelow","stepProgress","viewportAbove","viewportBelow"],r={},i={},s=null,a=[],l=[],c=[],f=[],u=0,p=0,d=0,v=0,g=0,m=0,x=!1,b=!1,w=!1,h=!1,y=!1,E=!1,M="down",I="percent",A=[];function C(e){console.error("scrollama error: "+e)}function O(){r={stepEnter:function(){},stepExit:function(){},stepProgress:function(){}},i={}}function S(e){return e.getBoundingClientRect().top+window.pageYOffset-(document.body.clientTop||0)}function B(e){return+e.getAttribute("data-scrollama-index")}function H(){window.pageYOffset>g?M="down":window.pageYOffset<g&&(M="up"),g=window.pageYOffset}function k(e){i[e]&&i[e].forEach(function(e){return e.disconnect()})}function _(){var t,n;d=window.innerHeight,t=document.body,n=document.documentElement,v=Math.max(t.scrollHeight,t.offsetHeight,n.clientHeight,n.scrollHeight,n.offsetHeight),p=u*("pixels"===I?1:d),x&&(l=a.map(function(e){return e.getBoundingClientRect().height}),c=a.map(S),b&&D()),w&&function(t){var n=t.id,o=t.offsetMargin,r=t.offsetVal,i="pixels"===t.format?"px":"",s=e(n),a=document.getElementById(s);a.style.top=o+"px",a.querySelector("span").innerText=""+r+i}({id:s,offsetMargin:p,offsetVal:u,format:I})}function N(e){if(e&&!b){if(!x)return C("scrollama error: enable() called before scroller was ready"),void(b=!1);D()}!e&&b&&o.forEach(k),b=e}function P(e,t){var n=B(e);void 0!==t&&(f[n].progress=t);var o={element:e,index:n,progress:f[n].progress};"enter"===f[n].state&&r.stepProgress(o)}function R(e,t){if("above"===t)for(var n=0;n<e;n+=1){var o=f[n];"enter"!==o.state&&"down"!==o.direction?(T(a[n],"down",!1),q(a[n],"down")):"enter"===o.state&&q(a[n],"down")}else if("below"===t)for(var r=f.length-1;r>e;r-=1){var i=f[r];"enter"===i.state&&q(a[r],"up"),"down"===i.direction&&(T(a[r],"up",!1),q(a[r],"up"))}}function T(e,t,o){void 0===o&&(o=!0);var i=B(e),a={element:e,index:i,direction:t};f[i].direction=t,f[i].state="enter",y&&o&&"down"===t&&R(i,"above"),y&&o&&"up"===t&&R(i,"below"),r.stepEnter&&!A[i]&&(r.stepEnter(a,f),w&&n({id:s,index:i,state:"enter"}),E&&(A[i]=!0)),h&&P(e)}function q(e,t){var o=B(e),i={element:e,index:o,direction:t};h&&("down"===t&&f[o].progress<1?P(e,1):"up"===t&&f[o].progress>0&&P(e,0)),f[o].direction=t,f[o].state="exit",r.stepExit(i,f),w&&n({id:s,index:o,state:"exit"})}function V(e){var t=e[0];H();var n=t.isIntersecting,o=t.boundingClientRect,r=t.target,i=o.top,s=o.bottom,a=i-p,l=s-p,c=B(r),u=f[c];n&&a<=0&&l>=0&&"down"===M&&"enter"!==u.state&&T(r,M),!n&&a>0&&"up"===M&&"enter"===u.state&&q(r,M)}function Y(e){var t=e[0];H();var n=t.isIntersecting,o=t.boundingClientRect,r=t.target,i=o.top,s=o.bottom,a=i-p,l=s-p,c=B(r),u=f[c];n&&a<=0&&l>=0&&"up"===M&&"enter"!==u.state&&T(r,M),!n&&l<0&&"down"===M&&"enter"===u.state&&q(r,M)}function F(e){var t=e[0];H();var n=t.isIntersecting,o=t.target,r=B(o),i=f[r];n&&"down"===M&&"down"!==i.direction&&"enter"!==i.state&&(T(o,"down"),q(o,"down"))}function j(e){var t=e[0];H();var n=t.isIntersecting,o=t.target,r=B(o),i=f[r];n&&"up"===M&&"down"===i.direction&&"enter"!==i.state&&(T(o,"up"),q(o,"up"))}function z(e){var t=e[0];H();var n=t.isIntersecting,o=t.intersectionRatio,r=t.boundingClientRect,i=t.target,s=r.bottom;n&&s-p>=0&&P(i,+o)}function L(){i.stepProgress=a.map(function(e,t){var n=l[t]-p+"px 0px "+(-d+p)+"px 0px",o=function(e){for(var t=Math.ceil(e/m),n=[],o=1/t,r=0;r<t;r+=1)n.push(r*o);return n}(l[t]),r=new IntersectionObserver(z,{rootMargin:n,threshold:o});return r.observe(e),r})}function D(){o.forEach(k),i.viewportAbove=a.map(function(e,t){var n=v-c[t],o=p-d-l[t],r=new IntersectionObserver(F,{rootMargin:n+"px 0px "+o+"px 0px"});return r.observe(e),r}),i.viewportBelow=a.map(function(e,t){var n=-p-l[t],o=p-d+l[t]+v,r=new IntersectionObserver(j,{rootMargin:n+"px 0px "+o+"px 0px"});return r.observe(e),r}),i.stepAbove=a.map(function(e,t){var n=-p+l[t],o=new IntersectionObserver(V,{rootMargin:n+"px 0px "+(p-d)+"px 0px"});return o.observe(e),o}),i.stepBelow=a.map(function(e,t){var n=-p,o=p-d+l[t],r=new IntersectionObserver(Y,{rootMargin:n+"px 0px "+o+"px 0px"});return r.observe(e),r}),h&&L()}function G(e){return!(!e||1!==e.nodeType)&&(function(e){var t=window.getComputedStyle(e);return("scroll"===t.overflowY||"auto"===t.overflowY)&&e.scrollHeight>e.clientHeight}(e)?e:G(e.parentNode))}var J={};return J.setup=function(e){var n=e.step,o=e.offset;void 0===o&&(o=.5);var r=e.progress;void 0===r&&(r=!1);var i=e.threshold;void 0===i&&(i=4);var l=e.debug;void 0===l&&(l=!1);var c=e.order;void 0===c&&(c=!0);var p,d,v,g,b,M=e.once;if(void 0===M&&(M=!1),O(),d=(p="abcdefghijklmnopqrstuv").length,v=Date.now(),s=""+[0,0,0].map(function(e){return p[Math.floor(Math.random()*d)]}).join("")+v,g=n,void 0===b&&(b=document),!(a="string"==typeof g?Array.from(b.querySelectorAll(g)):g instanceof Element?[g]:g instanceof NodeList?Array.from(g):g instanceof Array?g:[]).length)return C("no step elements"),J;var I=a.reduce(function(e,t){return e||G(t.parentNode)},!1);return I&&console.error("scrollama error: step elements cannot be children of a scrollable element. Remove any css on the parent element with overflow: scroll; or overflow: auto; on elements with fixed height.",I),w=l,h=r,y=c,E=M,J.offsetTrigger(o),m=Math.max(1,+i),x=!0,w&&t({id:s,stepEl:a,offsetVal:u}),a.forEach(function(e,t){return e.setAttribute("data-scrollama-index",t)}),f=a.map(function(){return{direction:null,state:null,progress:0}}),_(),J.enable(),J},J.resize=function(){return _(),J},J.enable=function(){return N(!0),J},J.disable=function(){return N(!1),J},J.destroy=function(){N(!1),O()},J.offsetTrigger=function(e){if(null===e)return u;if("number"==typeof e)I="percent",e>1&&C("offset value is greater than 1. Fallback to 1."),e<0&&C("offset value is lower than 0. Fallback to 0."),u=Math.min(Math.max(0,e),1);else if("string"==typeof e&&e.indexOf("px")>0){var t=+e.replace("px","");isNaN(t)?(C("offset value must be in 'px' format. Fallback to 0.5."),u=.5):(I="pixels",u=t)}else C("offset value does not include 'px'. Fallback to 0.5."),u=.5;return J},J.onStepEnter=function(e){return"function"==typeof e?r.stepEnter=e:C("onStepEnter requires a function"),J},J.onStepExit=function(e){return"function"==typeof e?r.stepExit=e:C("onStepExit requires a function"),J},J.onStepProgress=function(e){return"function"==typeof e?r.stepProgress=e:C("onStepProgress requires a function"),J},J}});
},{}],"Na4G":[function(require,module,exports) {
"use strict";function t(t){return n(t)||e(t)||r()}function r(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function e(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}function n(t){if(Array.isArray(t)){for(var r=0,e=new Array(t.length);r<t.length;r++)e[r]=t[r];return e}}function o(r){return t(new Set(r))}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=o;
},{}],"drU0":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var v='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">\n<path d="M0 4v24h32v-24h-32zM6 26h-4v-4h4v4zM6 18h-4v-4h4v4zM6 10h-4v-4h4v4zM24 26h-16v-20h16v20zM30 26h-4v-4h4v4zM30 18h-4v-4h4v4zM30 10h-4v-4h4v4zM12 10v12l8-6z"></path>\n</svg>';exports.default=v;
},{}],"hR3q":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=d3.select("body"),e=d3.select('[data-js="modal"]'),a=e.select(".modal__info"),n=e.select(".modal__video");function c(){var t=e.selectAll(".modal__quit, a, img").nodes(),a=t[0],n=t[t.length-1];a.focus(),d3.select(a).on("keydown",function(){if(!e.classed("is-hidden")){var t=d3.event.code,a=d3.event.shiftKey;"Tab"===t&&!0===a&&(d3.event.preventDefault(),n.focus())}}),d3.select(n).on("keydown",function(){if(!e.classed("is-hidden")){var t=d3.event.code,n=d3.event.shiftKey;"Tab"===t&&!1===n&&(d3.event.preventDefault(),a.focus())}}),e.on("keydown",function(){var t=d3.event.code,a=!e.classed("is-hidden");"Escape"===t&&!0===a&&d()}),d3.select(a).on("keydown",function(){"Enter"===d3.event.code&&d()})}function l(t,d,i,o,s){e.classed("is-hidden",!1);var r=d.filter(function(t){return t.id===s})[0],f=r.specific?r.specific:i;a.select(".modal__info-animal").text(f),a.select(".modal__info-facility").text(o),a.select(".modal__info-full").text(!0===r.camOn?"Go to the full live stream":"Go to the full live stream (camera may be currently offline)").attr("href",r.link).attr("target","_blank"),a.select(".modal__info-help"),e.select(".facility").text(o),e.select(".donate").attr("href",r.donate),r.adopt?e.select(".adopt").attr("href",r.adopt).attr("target","_blank").classed("is-hidden",!1):e.select(".adopt").classed("is-hidden",!0);var u=e.select(".modal__info-fact");r.fact?(u.classed("is-hidden",!1),u.select(".facility").text(o),u.select(".fact__text").text(r.fact),u.select(".fact__link").attr("href",r.learn).attr("target","_blank")):u.classed("is-hidden",!0);var _=t.filter(function(t){return t.animal===i})[0].camera.filter(function(t){return+t!=+r.id});n.select(".large").attr("tabindex",0).attr("src","https://pudding.cool/2020/11/zoo-data/output/".concat(r.id,".gif")).attr("alt",function(t){return"Image of ".concat(i," at ").concat(o)});var p=n.select(".modal__video--carousel");if(_.length>0){p.classed("is-hidden",!1);var v=d.map(function(t){return[+t.id,t.facility]}),m=new Map(v),h=p.selectAll(".g-carousel").data(_,function(t){return+t}).join(function(e){var a=e.append("div").attr("class","g-carousel");return a.append("img").attr("class","carousel__display").attr("tabindex",0).attr("alt",function(t){return"Image of ".concat(i," at ").concat(m.get(+t))}).on("click",function(e,a,n){d3.event.stopPropagation();var c=d3.select(n[a]).attr("data-id"),o=m.get(+c);l(t,d,i,o,c)}),a.append("span").attr("class","carousel__facility"),a});h.selectAll(".carousel__facility").text(function(t){return m.get(+t)}),h.selectAll("img").attr("data-id",function(t){return t}).attr("src",function(t){return"https://pudding.cool/2020/11/zoo-data/stills/".concat(+t,".png")})}else p.classed("is-hidden",!0);c()}function d(){e.classed("is-hidden",!0),t.classed("modal__open",!1)}e.on("click",d);var i={setup:l,close:d};exports.default=i;
},{}],"CAFt":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=e(require("./load-data"));function e(t){return t&&t.__esModule?t:{default:t}}function r(t,e){return o(t)||a(t,e)||n()}function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function a(t,e){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t)){var r=[],n=!0,a=!1,o=void 0;try{for(var i,u=t[Symbol.iterator]();!(n=(i=u.next()).done)&&(r.push(i.value),!e||r.length!==e);n=!0);}catch(l){a=!0,o=l}finally{try{n||null==u.return||u.return()}finally{if(a)throw o}}return r}}function o(t){if(Array.isArray(t))return t}var i=d3.selectAll(".globe"),u=i.selectAll("svg"),l=null,s=d3.geoOrthographic(),c=d3.geoPath(s),p=5,f={type:"Sphere"},h=1e3,d=null,M=null,y=null,v=[0,0],g=[0,0],m=[52.3,-84,0],b=[52.3,-84,0];function x(t,e){var n=r(t,4),a=n[0],o=n[1],i=n[2],u=n[3],l=r(e,4),s=l[0],c=l[1],p=l[2],f=l[3];s-=a,c-=o,p-=i,f-=u;var h=new Array(4);return function(t){var e=Math.hypot(h[0]=a+s*t,h[1]=o+c*t,h[2]=i+p*t,h[3]=u+f*t);return h[0]/=e,h[1]/=e,h[2]/=e,h[3]/=e,h}}function A(t,e){var n=r(t,4),a=n[0],o=n[1],i=n[2],u=n[3],l=r(e,4),s=l[0],c=l[1],p=l[2],f=l[3],h=a*s+o*c+i*p+u*f;if(h<0&&(s=-s,c=-c,p=-p,f=-f,h=-h),h>.9995)return x([a,o,i,u],[s,c,p,f]);var d=Math.acos(Math.max(-1,Math.min(1,h))),M=new Array(4),y=Math.hypot(s-=a*h,c-=o*h,p-=i*h,f-=u*h);return s/=y,c/=y,p/=y,f/=y,function(t){var e=d*t,r=Math.sin(e),n=Math.cos(e);return M[0]=a*n+s*r,M[1]=o*n+c*r,M[2]=i*n+p*r,M[3]=u*n+f*r,M}}function P(t){var e=r(t,3),n=e[0],a=e[1],o=e[2];n*=Math.PI/360,a*=Math.PI/360,o*=Math.PI/360;var i=Math.sin(n),u=Math.cos(n),l=Math.sin(a),s=Math.cos(a),c=Math.sin(o),p=Math.cos(o);return[u*s*p+i*l*c,i*s*p-u*l*c,u*l*p+i*s*c,u*s*c-i*l*p]}function j(t){var e=r(t,4),n=e[0],a=e[1],o=e[2],i=e[3];return[180*Math.atan2(2*(n*a+o*i),1-2*(a*a+o*o))/Math.PI,180*Math.asin(Math.max(-1,Math.min(1,2*(n*o-i*a))))/Math.PI,180*Math.atan2(2*(n*i+a*o),1-2*(o*o+i*i))/Math.PI]}function w(t,e){var r=A(P(t),P(e));return function(t){return j(r(t))}}function I(t,e){if(M){var r=M.features.filter(function(t){return"CA"===t.properties.iso_a2})[0],n=(M.features.filter(function(t){return"US"===t.properties.iso_a2})[0],s([e,t])),a=(s.invert(n),d3.geoCentroid(r));s.invert(a);v=g,m=b,b=[-(g=[e,t])[0],p-g[1],0];var o=w(m,b),i=d.selectAll(".path-country");d3.transition().duration(h).tween("render",function(){return function(t){s.rotate(o(t)),i.attr("d",c)}})}}function _(){l.append("path").attr("id","globe--top").attr("d","M-4,50 A 54,54 0 0,1 104,50").style("fill","none").style("stroke","none"),l.append("path").attr("id","globe--bottom").attr("d","M-12,50 A 62,62 0 0,0 112,50").style("fill","none").style("stroke","none"),l.append("text").append("textPath").attr("xlink:href","#globe--bottom").style("text-anchor","middle").style("text-baseline","hanging").attr("startOffset","50%").text("Center of Wild Range").attr("font-size","14px")}function S(t){u.selectAll(".marker").data(t).join(function(t){return t.append("circle").attr("class","marker").attr("r",15)})}function k(){}function O(t){(l=u.append("g").attr("class","g-globe")).style("transform","translate(15px, 15px)"),(d=l.append("g").attr("class","g-map")).append("path").attr("class","path-sphere"),d.append("g").attr("class","g-countries");s.fitSize([100,100],t).center([0,0]).rotate([52.3,-84,0]),d.select(".path-sphere").attr("d",c(f)).lower(),d.select(".g-countries").selectAll(".path-country").data(t.features).join(function(t){return t.append("path").attr("class",function(t){return"path-country country-".concat(t.properties.iso_a2)})}).attr("d",c),M=t,_()}function z(e){y=e,(0,t.default)("custom2.geojson").then(function(t){return O(t)})}var C={init:z,update:I,resize:k};exports.default=C;
},{"./load-data":"xZJw"}],"g1DG":[function(require,module,exports) {
"use strict";function e(e){var t=this.constructor;return this.then(function(r){return t.resolve(e()).then(function(){return r})},function(r){return t.resolve(e()).then(function(){return t.reject(r)})})}Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=e;exports.default=t;
},{}],"gqUM":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=t(require("./finally"));function t(e){return e&&e.__esModule?e:{default:e}}var n=setTimeout;function o(e){return Boolean(e&&void 0!==e.length)}function r(){}function i(e,t){return function(){e.apply(t,arguments)}}function u(e){if(!(this instanceof u))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],d(e,this)}function f(e,t){for(;3===e._state;)e=e._value;0!==e._state?(e._handled=!0,u._immediateFn(function(){var n=1===e._state?t.onFulfilled:t.onRejected;if(null!==n){var o;try{o=n(e._value)}catch(r){return void a(t.promise,r)}c(t.promise,o)}else(1===e._state?c:a)(t.promise,e._value)})):e._deferreds.push(t)}function c(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var n=t.then;if(t instanceof u)return e._state=3,e._value=t,void l(e);if("function"==typeof n)return void d(i(n,t),e)}e._state=1,e._value=t,l(e)}catch(o){a(e,o)}}function a(e,t){e._state=2,e._value=t,l(e)}function l(e){2===e._state&&0===e._deferreds.length&&u._immediateFn(function(){e._handled||u._unhandledRejectionFn(e._value)});for(var t=0,n=e._deferreds.length;t<n;t++)f(e,e._deferreds[t]);e._deferreds=null}function s(e,t,n){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=n}function d(e,t){var n=!1;try{e(function(e){n||(n=!0,c(t,e))},function(e){n||(n=!0,a(t,e))})}catch(o){if(n)return;n=!0,a(t,o)}}u.prototype.catch=function(e){return this.then(null,e)},u.prototype.then=function(e,t){var n=new this.constructor(r);return f(this,new s(e,t,n)),n},u.prototype.finally=e.default,u.all=function(e){return new u(function(t,n){if(!o(e))return n(new TypeError("Promise.all accepts an array"));var r=Array.prototype.slice.call(e);if(0===r.length)return t([]);var i=r.length;function u(e,o){try{if(o&&("object"==typeof o||"function"==typeof o)){var f=o.then;if("function"==typeof f)return void f.call(o,function(t){u(e,t)},n)}r[e]=o,0==--i&&t(r)}catch(c){n(c)}}for(var f=0;f<r.length;f++)u(f,r[f])})},u.resolve=function(e){return e&&"object"==typeof e&&e.constructor===u?e:new u(function(t){t(e)})},u.reject=function(e){return new u(function(t,n){n(e)})},u.race=function(e){return new u(function(t,n){if(!o(e))return n(new TypeError("Promise.race accepts an array"));for(var r=0,i=e.length;r<i;r++)u.resolve(e[r]).then(t,n)})},u._immediateFn="function"==typeof setImmediate&&function(e){setImmediate(e)}||function(e){n(e,0)},u._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)};var h=u;exports.default=h;
},{"./finally":"g1DG"}],"S90c":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var t=o(require("./load-data")),n=o(require("./utils/load-image-promise"));require("intersection-observer");var e=o(require("scrollama")),a=o(require("./utils/unique")),i=o(require("./videoSVG")),r=o(require("./modal")),c=o(require("./globe")),l=require("promise-polyfill");function o(t){return t&&t.__esModule?t:{default:t}}function s(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);n&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable})),e.push.apply(e,a)}return e}function u(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?s(e,!0).forEach(function(n){d(t,n,e[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):s(e).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))})}return t}function d(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var f=d3.select("body"),p=f.selectAll('[data-js="arrangement"]'),m=p.selectAll('[data-js="arrangement__islands"]'),g=d3.selectAll('[data-js="navigation"]'),h=g.select(".animal"),y=d3.select(".update"),v=[],b=null,x=null,A=null,_=null,w=16,j=100,P=848,k=!1,O=!1,E=!1,q=1228,S=1200,X={1:"21.2%",2:"16.7%",3:"11.7%",4:"9.02%",5:"7.33%"},z={1:"48.4%",2:"18.65%",3:"13.1%",4:"10.1%",5:"8.2%"},D=(0,e.default)(),G=(0,e.default)();function M(t){var n=d3.select(t),e=n.attr("data-id");"png"===n.attr("data-type")?(n.attr("src","https://pudding.cool/2020/11/zoo-data/output/".concat(e,".gif")),n.attr("data-type","gif")):(n.attr("src","https://pudding.cool/2020/11/zoo-data/stills/".concat(e,".png")),n.attr("data-type","png"))}var R=function(t){return new Promise(function(n){return setTimeout(n,t)})};function V(t){p.selectAll(".g-anno").classed("in-focus",!1);var n=d3.select(t).attr("data-animal");p.selectAll('[data-list="'.concat(n,'"]')).classed("in-focus",!0).selectAll("li")}function Y(){G.setup({step:".g-island",offset:.8,debug:!1}).onStepEnter(function(t){var n=t.element,e=t.index;t.direction,d3.select(n);e===w&&p.selectAll(".clouds__base, .globe").classed("is-hidden",!1)}).onStepExit(function(t){t.element;var n=t.index,e=t.direction;n===w&&"down"===e&&p.selectAll(".clouds__base, .globe").classed("is-hidden",!0)})}function H(){D.setup({step:".cam__display",debug:!1}).onStepEnter(function(t){var n=t.element,e=t.index,a=t.direction;if(!1===(0===e&&"down"===a)){var i=m.select('[data-type="gif"]');i&&(M(i.node()),i.classed("in-focus",!1))}M(n),p.selectAll(".cam__display").classed("in-focus",!1);var r=d3.select(n);r.classed("in-focus",!0),V(n);var l=r.data()[0],o=l.lat,s=l.long;if(c.default.update(+o,+s),k){h.selectAll(".g-anno").classed("is-hidden",!0);var u=d3.select(n).attr("data-animal"),d=h.selectAll(".g-anno").filter(function(t,n,e){return d3.select(e[n]).attr("data-list")===u});d.classed("is-hidden",!1),d.node().scrollIntoView({behavior:"smooth",block:"center"})}}).onStepExit(function(t){var n=t.element,e=t.index,a=t.direction;if(1===e&&"up"===a){d3.select(n).classed("in-focus",!1),M(n);var i=d3.selectAll(".cam__display").filter(function(t,n,e){return"polar bear"===d3.select(e[n]).attr("data-animal")});M(i.node()),i.classed("in-focus",!0),V(i.node())}})}function N(t,n){return t.split(", ").map(function(t){return{id:t,facility:n.get(t)}}).sort(function(t,n){return d3.ascending(t.facility,n.facility)})[0].id}function F(t,n){return new Promise(function(e){var a=t[1].map(function(t){return u({},t,{camOn:n.includes(+t.id)})});b=a,_=new Map(b.map(function(t){return[t.id,t.facility]})),x=t[0].map(function(t){return u({},t,{index:+t.index,positionY:+t.positionY,camera:t.camera.split(", "),first:N(t.camera,_)})}),A=d3.nest().key(function(t){return t.tile}).entries(x),e({mappedData:x,nestedData:A,links:a})})}function L(t){var n=t.attr("data-animal"),e=t.attr("data-id"),a=p.selectAll('[data-list="'.concat(n,'"]')).select(".animal--facility.selected").attr("data-facility");f.classed("modal__open",!0),r.default.setup(x,b,n,a,e)}function I(t,n){var e=t.index,a=2*t.positionY,i="R"===t.positionX?2:1;return e%2==0?"".concat(a," / ").concat(i+1," / span 1 / span 1"):1===e?"".concat(a," / ").concat(i+1," / span 1 / span 1"):"".concat(a," / ").concat(i," / span 1 / span 1 ")}function T(){k=window.innerWidth<P,m.selectAll(".exhibit").nodes().forEach(function(t){var n=d3.select(t).attr("data-tile"),e=t.offsetHeight;v[n]=e}),m.selectAll(".tile, .annotation--desktop").style("height",function(t){return"".concat(v[t[0].tile],"px")}),B()}function W(t){t.selectAll("fieldset").selectAll(".animal--facility").data(function(t){var n=t.animal;return b.filter(function(t){return t.animal===n}).map(function(n){return u({},n,{tile:t.tile,positionX:t.positionX})}).sort(function(t,n){return d3.ascending(t.facility,n.facility)})}).join(function(t){var n=t.append("div").attr("class","wrapper");n.append("input").attr("type","radio").attr("value",function(t){return t.id}).attr("class","animal--facility").attr("id",function(t){return"facility--".concat(t.id)}).attr("data-facility",function(t){return t.facility}).attr("data-id",function(t){return t.id}).attr("data-animal",function(t){return t.animal}).attr("data-tile",function(t){return t.tile}).attr("tabindex",function(t,n){return 0===n?0:-1}).property("checked",function(t){var n=p.select('[data-exhibit="'.concat(t.tile,'"]')).selectAll(".cam__display").filter(function(n,e,a){return d3.select(a[e]).attr("data-animal")===t.animal}).attr("data-id");return t.id===n}).classed("selected",function(t){var n=p.select('[data-exhibit="'.concat(t.tile,'"]')).selectAll(".cam__display").filter(function(n,e,a){return d3.select(a[e]).attr("data-animal")===t.animal}).attr("data-id");return t.id===n?"checked":""}).on("click",C).select(".video--icon").classed("is-hidden",function(t){var n=p.select('[data-exhibit="'.concat(t.tile,'"]')).selectAll(".cam__display").filter(function(n,e,a){return d3.select(a[e]).attr("data-animal")===t.animal}).attr("data-id");return t.id!==n});n.append("label").attr("for",function(t){return"facility--".concat(t.id)}).text(function(t){return t.facility})})}function B(){if(!0===k&&!1===O)O=!0,W(h.selectAll(".g-anno").data(x).join(function(t){var n=t.append("div").attr("class","g-anno").attr("data-list",function(t){return t.animal}).style("align-self",function(t){return"L"===t.positionX?"flex-start":"flex-end"});return n.append("h3").attr("class","animal--name").text(function(t){return t.animal}).attr("data-animal",function(t){return t.animal}).attr("data-id",function(t){return t.id}).style("text-align",function(t){return"L"===t.positionX?"left":"right"}).on("click",function(t,n,e){return L(d3.select(e[n]))}),n.append("fieldset").attr("class","animal--list").attr("data-animal",function(t){return t.animal}).attr("tabindex",0).append("legend").text(function(t){return"Facilities with a ".concat(t.animal," live stream")}).attr("class","sr-only"),n}));else if(!1===k&&!1===E){E=!0,W(m.selectAll(".g-island").selectAll(".annotation--desktop").data(function(t){return[t.values]}).join(function(t){return t.append("div").attr("class","annotation--desktop")}).style("grid-template-rows",function(t){return J(t)}).style("height",function(t){return"".concat(v[t[0].tile],"px")}).selectAll(".g-anno").data(function(t){return t}).join(function(t){var n=t.append("div").attr("class","g-anno").attr("data-list",function(t){return t.animal});return n.append("h3").attr("class","animal--name").text(function(t){return t.display?t.display:t.animal}).attr("data-animal",function(t){return t.animal}).attr("data-id",function(t){return t.camera[0]}).on("click",function(t,n,e){return L(d3.select(e[n]))}),n.append("fieldset").attr("class","animal--list").attr("data-animal",function(t){return t.animal}).attr("tabindex",0).append("legend").text(function(t){return"Facilities with a ".concat(t.animal," live stream")}).attr("class","sr-only"),n}).style("grid-area",function(t,n){return"".concat(2*t.positionY," / 1 / span 1 / span 1 ")}))}}function C(){var t=d3.select(this),n=t.attr("data-id"),e=t.attr("data-animal"),a=t.attr("data-tile"),i=p.select('[data-exhibit="'.concat(a,'"]')),r=null;(r=k?h.selectAll("fieldset").filter(function(t,n,a){return d3.select(a[n]).attr("data-animal")===e}).selectAll("input"):i.selectAll("fieldset").filter(function(t,n,a){return d3.select(a[n]).attr("data-animal")===e}).selectAll("input")).property("checked",!1),r.selectAll(".video--icon").classed("is-hidden",!0),t.property("checked",!0),t.select(".video--icon").classed("is-hidden",!1);var c=i.selectAll(".cam__display").filter(function(t,n,a){return d3.select(a[n]).attr("data-animal")===e});"png"===c.attr("data-type")?c.attr("src","https://pudding.cool/2020/11/zoo-data/stills/".concat(n,".png")).attr("data-id",n).attr("alt",function(t){return"Still image of ".concat(e," at ").concat(_.get(n))}):c.attr("src","https://pudding.cool/2020/11/zoo-data/output/".concat(n,".gif")).attr("data-id",n).attr("alt",function(t){return"Video clip of ".concat(e," at ").concat(_.get(n))})}function J(t){var n=+t[0].shape.split("")[1],e=X[n],a=z[n];return 1===n?"".concat(e," 1fr ").concat(a):"".concat(e," repeat(").concat(n-1,", minmax(0, 1fr) ").concat(a,") minmax(0, 1fr) ").concat(e)}function K(){var t=A;m.selectAll(".g-island").data(t).join(function(t){return t.append("div").attr("class","g-island").attr("data-exhibit",function(t){return"".concat(t.key)}).style("order",function(t,n){return 0===n?0:n+1})}).selectAll(".tile").data(function(t){return[t.values]}).join(function(t){var n=t.append("div").attr("class",function(t){return"tile tile__".concat(t[0].shape)}).style("grid-template-rows",function(t,n){return J(t)});return n.append("img").attr("class","exhibit").attr("src",function(t){return"assets/images/".concat(t[0].tile,"-0.PNG")}).attr("data-tile",function(t){return t[0].tile}).attr("aria-hidden",!0).style("grid-area",function(t,n,e){var a=t[0].index;return(a%2!=0||k)&&(1!==a||k)?"1 / 1 / ".concat(t.length+1," / 3"):"1 / 2 / ".concat(t.length+1," / 4")}),n.selectAll(".exhibit").nodes().forEach(function(t){var n=d3.select(t).attr("data-tile"),e=t.offsetHeight;v[n]=e}),n.append("img").attr("class","exhibit-top").attr("src",function(t){return"assets/images/".concat(t[0].tile,"-2.PNG")}).attr("aria-hidden",!0).style("grid-area",function(t,n,e){var a=t[0].index;return(a%2!=0||k)&&(1!==a||k)?"1 / 1 / ".concat(t.length+1," / 3"):"1 / 2 / ".concat(t.length+1," / 4")}),n}).selectAll(".cam__display").data(function(t){return t}).join(function(t){t.append("img").attr("class","cam__display").attr("data-id",function(t){return t.first}).attr("data-type","png").attr("data-animal",function(t){return t.animal}).attr("tabindex",0).attr("alt",function(t){return"Video clip of ".concat(t.animal," at ").concat(_.get(t.first))}).style("justify-self",function(t){return"R"===t.positionX?"start":"end"}).style("margin-right",function(t){return"R"===t.positionX?0:"-4%"}).style("margin-left",function(t){var n="R"===t.positionX?"-4%":0;return"polar"===t.tile?"-40%":n}).attr("src",function(t){return"https://pudding.cool/2020/11/zoo-data/stills/".concat(t.first,".png")}).style("grid-area",function(t,n){return I(t,n)}).on("click",function(t,n,e){return L(d3.select(e[n]))}).on("keydown",function(t,n,e){"Enter"===d3.event.code&&L(d3.select(e[n]))})})}function Q(){var t=A;return new Promise(function(e){for(var a=[],i=function(i){var r=(0,n.default)("assets/images/".concat(t[i].key,"-0.PNG"));r.then(function(n){n.onload(function(){i===t.length&&e()})}),a.push(r)},r=0;r<t.length;++r)i(r);Promise.all(a).then(e).catch(function(t){return console.log("Error in loading images")})}).catch(function(t){return console.error("Error with preload ".concat(t))})}function U(){return new Promise(function(t,n){d3.json("https://pudding.cool/2020/11/zoo-data/timestamps.json").then(function(n){var e=n.map(function(t){return u({},t,{id:+t.id,timestamp:+t.timestamp})}).sort(function(t,n){return d3.descending(t.timestamp,n.timestamp)}).shift(),a=Date.now(),i=d3.timeMinute.count(e.timestamp,a),r=n.map(function(t){return+t.id});y.text(function(){return i<60?"~".concat(i," minutes ago"):"~".concat(d3.timeHour.count(e.timestamp,a)," hours ago")}),t(r)}).catch(function(t){return n(t)})})}function Z(){return new Promise(function(t,n){try{K(),c.default.init(x),t()}catch(e){n(e)}})}function $(){return new Promise(function(t,n){try{H(),Y(),T(),t()}catch(e){n(e)}})}function tt(){(0,t.default)(["assets/data/arrangement.csv","assets/data/links.csv"]).then(function(t){return U().then(function(n){F(t,n)})}).then(function(){return Q()}).then(function(){return Z()}).then(function(){return $()})}var nt={init:tt,resize:T};exports.default=nt;
},{"./load-data":"xZJw","./utils/load-image-promise":"VKu2","intersection-observer":"CRRU","scrollama":"vL5c","./utils/unique":"Na4G","./videoSVG":"drU0","./modal":"hR3q","./globe":"CAFt","promise-polyfill":"gqUM"}],"v9Q8":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e=[{image:"2018_02_stand-up",url:"2018/02/stand-up",hed:"The Structure of Stand-Up Comedy"},{image:"2018_04_birthday-paradox",url:"2018/04/birthday-paradox",hed:"The Birthday Paradox Experiment"},{image:"2018_11_boy-bands",url:"2018/11/boy-bands",hed:"Internet Boy Band Database"},{image:"2018_08_pockets",url:"2018/08/pockets",hed:"Womenâ€™s Pockets are Inferior"}],t=null;function n(e,t){var n=document.getElementsByTagName("script")[0],o=document.createElement("script");return o.src=e,o.async=!0,n.parentNode.insertBefore(o,n),t&&"function"==typeof t&&(o.onload=t),o}function o(t){var n=new XMLHttpRequest,o=Date.now(),r="https://pudding.cool/assets/data/stories.json?v=".concat(o);n.open("GET",r,!0),n.onload=function(){if(n.status>=200&&n.status<400){var o=JSON.parse(n.responseText);t(o)}else t(e)},n.onerror=function(){return t(e)},n.send()}function r(e){return"\n\t<a class='footer-recirc__article' href='https://pudding.cool/".concat(e.url,"' target='_blank' rel='noopener'>\n\t\t<img class='article__img' src='https://pudding.cool/common/assets/thumbnails/640/").concat(e.image,".jpg' alt='").concat(e.hed,"'>\n\t\t<p class='article__headline'>").concat(e.hed,"</p>\n\t</a>\n\t")}function a(){var e=window.location.href,n=t.filter(function(t){return!e.includes(t.url)}).slice(0,4).map(r).join("");d3.select(".pudding-footer .footer-recirc__articles").html(n)}function s(){o(function(e){t=e,a()})}var c={init:s};exports.default=c;
},{}],"epB2":[function(require,module,exports) {
"use strict";var e=a(require("lodash.debounce")),i=a(require("./utils/is-mobile")),s=a(require("./utils/link-fix")),t=a(require("./graphic")),r=a(require("./arrangement")),l=a(require("./footer"));function a(e){return e&&e.__esModule?e:{default:e}}var d=d3.select("body"),u=0;function n(){var e=d.node().offsetWidth;u!==e&&(u=e,t.default.resize(),r.default.resize())}function c(){if(d.select("header").classed("is-sticky")){var e=d.select(".header__menu"),i=d.select(".header__toggle");i.on("click",function(){var s=e.classed("is-visible");e.classed("is-visible",!s),i.classed("is-visible",!s)})}}function f(){(0,s.default)(),d.classed("is-mobile",i.default.any()),window.addEventListener("resize",(0,e.default)(n,150)),c(),r.default.init(),l.default.init()}f();
},{"lodash.debounce":"or4r","./utils/is-mobile":"WEtf","./utils/link-fix":"U9xJ","./graphic":"TAPd","./arrangement":"S90c","./footer":"v9Q8"}]},{},["epB2"], null)